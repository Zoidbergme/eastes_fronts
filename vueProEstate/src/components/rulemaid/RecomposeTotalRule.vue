<template>

<el-form id="AddTotalRule" ref="form" :rules="rules" :model="form"  label-width="200px">
<el-row style="height:40px;padding-left:40px;background:#545c64 ;">
	<el-col :span="12">
		<span class="check-basetitle">新增基本规则</span>
	</el-col>
	<el-col :span="8" :push="4" >
		 <el-form-item>
    		<el-button size="small" type="primary" @click="onSubmit">确认</el-button>
    		<el-button size="small" @click="back" >取消</el-button>
  		</el-form-item>
	</el-col>
</el-row>
<el-row >	
   	<el-col :span="12">
   	  <el-form-item   label="*开始执行时间">
         <el-date-picker   @change="CheckTime" type="date"required placeholder="选择日期" v-model="form.begin_time" style="width: 90%;"></el-date-picker>
      </el-form-item>
   	</el-col>
    <el-col :span="12">
    	 <el-form-item   label="*截止执行时间">
         <el-date-picker @change="CheckTime" type="date" required placeholder="选择日期" v-model="form.end_time" style="width: 90%;"></el-date-picker> 
 	    </el-form-item>
 	</el-col>    
</el-row> 	    
    
<el-row>
    <el-col :span="12">
    	 <el-form-item prop="valid_visit_time" label="到访确认保护期(分钟)：">
    			<el-input type="number" v-model="form.valid_visit_time" required placeholder="请输入失效时间,如:60" style="width: 90%;"></el-input>
  		</el-form-item>
    </el-col> 
</el-row>
<el-row>
    <el-col :span="12">
    	 <el-form-item prop="visit_confirm_time" label="有效来访保护期(天)：">
    			<el-input type="number" v-model="form.visit_confirm_time" placeholder="请输入失效时间,如:1"  style="width: 90%;"></el-input>
  		</el-form-item>
    </el-col> 
</el-row>
<el-row>
    <el-col :span="12">
    	 <el-form-item  prop="make_bargain_time" label="成交保护期(天)：">
    			<el-input type="number" v-model="form.make_bargain_time" required  placeholder="请输入失效时间,如1"  style="width: 90%;"></el-input>
  		</el-form-item>
    </el-col> 
</el-row>
 <el-row>
 	<el-col :span="12">
 	  <el-form-item  label="推荐佣金结款周期">
    		<el-select v-model="form.intro_pay_time" style="width: 90%;" placeholder="请选择结佣时间">
              <el-option label="一个工作日后" value="1"></el-option>
              <el-option label="两个工作日后" value="2"></el-option>
              <el-option label="七个工作日后" value="7"></el-option>
           </el-select>
     </el-form-item>
 	</el-col>
 </el-row>
  <el-row>
 	<el-col :span="12">
 	  <el-form-item  label="到访佣金结款周期">
    		<el-select v-model="form.visit" style="width: 90%;" placeholder="请选择结佣时间">
              <el-option label="一个工作日后" value="1"></el-option>
              <el-option label="两个工作日后" value="2"></el-option>
              <el-option label="七个工作日后" value="7"></el-option>
           </el-select>
     </el-form-item>
 	</el-col>
 </el-row>
 <el-row>
 	<el-col :span="12">
 	  <el-form-item  label="成交佣金结款周期">
    		<el-select  v-model="form.deel" style="width: 90%;" placeholder="请选择结佣时间">
              <el-option label="一个工作日后" value="1"></el-option>
              <el-option label="两个工作日后" value="2"></el-option>
              <el-option label="七个工作日后" value="7"></el-option>
           </el-select>
     </el-form-item>
 	</el-col>
 	<el-col :span="12">
 	  <el-form-item  label="成交结款条件">
    		<el-select @change="isUpload" v-model="form.region" style="width: 90%;" placeholder="请选择结佣条件">
              <el-option label="已签订单，且付定金" value="1"></el-option>
              <el-option label="签订购房合同，且付房款" value="2"></el-option>      
           </el-select>
     </el-form-item>
 	</el-col>
 </el-row>
 <el-row>
  <el-col :span="23" >
  	 <el-form-item prop="remark" label="备注：">
    	<el-input @change="isUpload" type="textarea" v-model="form.desc"></el-input>
 	 </el-form-item>
  </el-col>	 
</el-row> 
</el-form>

</template>

<script>
	export default{
	name:'AddTotalRule',
	data() {
     return {
     		canUpload:false,
      		form: {
         		 visit_confirm_time: '',
         		 valid_visit_time:'',
         		 make_bargain_time:'',
         		 comment:'1',		
         		 begin_time: '',
          		 end_time: '',
          		 intro_pay_time:"",
          		 visit_pay_time:'',
          		 deal_pay_time:'',
          		 deal_pay_condition:'',
          		 remark:""
        	},
        	rules:{
          		 	begin_time:[
          		 		{type:"data",required:true,message:'请选择开始日期',trigger:'blur'},
          		 	],
          		 	end_time:[
          		 		{type:'data',required:true,message:'请选择截止日期',trigger:'blur'}
          		 	],
          		 	valid_visit_time:[
          		 		{type:"number",required:true,message:"保护时间错误",trigger:"blur"},
          		 		{min:1,max:4,message:'时间位数超过1-4位',trigger:'blur'}
          		 	],
          		 	visit_confirm_time:[
          		 		{type:'number',required:true,message:'有效来访时间错误',trigger:"blur"},
          		 		{min:1,max:4,message:'时间位数超过1-4位',trigger:'blur'}
          		 	],
          		 	make_bargain_time:[
          		 		{type:"number",required:true,message:"成交保护时间错误",trigger:'blur'},
          		 		{min:1,max:4,message:'时间位数超过1-4位',trigger:'blur'}
          		 	],
          		 	intro_pay_time:[
          		 		{required:true,message:'请选择推荐结佣周期',trigger:'blur'}
          		 	],
          		 	visit_pay_time:[
          		 		{required:true,message:'请选择到访结佣周期',trigger:'blur'}
          		 	],
          		 	deal_pay_time:[
          		 		{required:true,message:'请选择成交结佣周期',trigger:'blur'}
          		 	],
          		 	deal_pay_condition:[
          		 		{required:true,message:'请选择成交结款条件',trigger:'blur'}
          		 	],
          		 	remark:[
          		 		{required:true,message:'请输入备注',trigger:'blur'},
          		 		{min:1,max:200,message:'输入字数超过1-200字',trigger:'blur'}
          		 	]
          	}
        }
    },
    methods: {
      onSubmit() {
        if(this.canUpload){
      		let url=this.Rooturl+"project/ruleBasic/create";
      		this.$http.post(url,{
      			...this.form  
      		}).then(res=>{
      		if(res.code==2){
      			this.$message.success(res.msg);
      			this.$router.push({path:'/index/CommissioCheck'})
      		}else{
      			this.$message.error("提交失败")
      		}
      		})
      	 }else{
      	 	this.$message.error("请核对所有选项");
      	 }
         
      },
      back(){
      	 this.$router.push({ path: "/index/CommissioCheck" });
      },  
      CheckTime(){
      	if(this.form.begin_time>this.form.end_time){
      		this.$message.error("截止日期不能小于开始日期");
      		this.canUpload=false;
      	}
      	if(!this.form.begin_time){
      		this.$message.error("请选择开始日期");
      		this.canUpload=false;
      	}
      	if(!this.form.end_time){
      		this.$message.error("请选择截止日期");
      		this.canUpload=false;
      	}
      },
      isUpload(){
      	if(!this.form.remark){
      		this.canUpload=true;
      	}
      }
      
   	},
	created(){
		
        
	}
}
</script>
	
<style>
	#AddTotalRule el-date-picker {
 		 width: 275px !important;
	}
	#AddTotalRule .check-basetitle{
		height:40px;
		line-height:40px;
		color:#fff;
	}
</style>